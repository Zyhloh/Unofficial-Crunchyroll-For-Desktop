<Window x:Class="CrunchyrollForDesktop.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:CrunchyrollForDesktop"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
        mc:Ignorable="d"
        Title="Crunchyroll For Desktop"
        Icon="images/icon.ico"
        Width="1400" Height="900"
        WindowStyle="None"
        ResizeMode="CanResize"
        Background="Transparent"
        AllowsTransparency="True"
        UseLayoutRounding="True"
        SnapsToDevicePixels="True">
    
    <shell:WindowChrome.WindowChrome>
        <shell:WindowChrome CaptionHeight="42"
                            CornerRadius="0"
                            GlassFrameThickness="0"
                            ResizeBorderThickness="5"
                            UseAeroCaptionButtons="False" />
    </shell:WindowChrome.WindowChrome>

    <Border x:Name="MainBorder" Background="#FF0F0F0F" CornerRadius="12">
        <Grid>
            <Grid.Resources>
            <!-- Modern 3D window control button style -->
            <Style x:Key="ModernWindowButton" TargetType="Button">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Width" Value="28"/>
                <Setter Property="Height" Value="28"/>
                <Setter Property="FontFamily" Value="Segoe Fluent Icons,Segoe MDL2 Assets"/>
                <Setter Property="FontSize" Value="10"/>
                <Setter Property="Foreground" Value="#CCFFFFFF"/>
                <Setter Property="Margin" Value="2"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Grid>
                                <Border x:Name="ButtonBorder" 
                                        Background="Transparent"
                                        CornerRadius="6"/>
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,1,0,0"/>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="ButtonBorder" Property="Background" Value="#FF3A3A3A"/>
                                    <Setter Property="Foreground" Value="#FFFFFF"/>
                                    <Setter TargetName="ButtonBorder" Property="Effect">
                                        <Setter.Value>
                                            <DropShadowEffect Color="#000000"
                                                              Direction="270"
                                                              ShadowDepth="2"
                                                              BlurRadius="4"
                                                              Opacity="0.4"/>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="ButtonBorder" Property="Background" Value="#FF1A1A1A"/>
                                    <Setter Property="Foreground" Value="#FFFFFF"/>
                                    <Setter TargetName="ButtonBorder" Property="Effect">
                                        <Setter.Value>
                                            <DropShadowEffect Color="#000000"
                                                              Direction="270"
                                                              ShadowDepth="1"
                                                              BlurRadius="2"
                                                              Opacity="0.6"/>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            
            <!-- Close button with red hover and 3D effect -->
            <Style x:Key="ModernCloseButton" BasedOn="{StaticResource ModernWindowButton}" TargetType="Button">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Grid>
                                <Border x:Name="ButtonBorder" 
                                        Background="Transparent"
                                        CornerRadius="6"/>
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,1,0,0"/>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="ButtonBorder" Property="Background" Value="#E81123"/>
                                    <Setter Property="Foreground" Value="White"/>
                                    <Setter TargetName="ButtonBorder" Property="Effect">
                                        <Setter.Value>
                                            <DropShadowEffect Color="#000000"
                                                              Direction="270"
                                                              ShadowDepth="2"
                                                              BlurRadius="4"
                                                              Opacity="0.4"/>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="ButtonBorder" Property="Background" Value="#C50F1F"/>
                                    <Setter Property="Foreground" Value="White"/>
                                    <Setter TargetName="ButtonBorder" Property="Effect">
                                        <Setter.Value>
                                            <DropShadowEffect Color="#000000"
                                                              Direction="270"
                                                              ShadowDepth="1"
                                                              BlurRadius="2"
                                                              Opacity="0.6"/>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </Grid.Resources>
        
        <Grid.RowDefinitions>
            <RowDefinition x:Name="TitleBarRow" Height="42"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Modern Custom Title Bar -->
        <Border x:Name="TitleBarContainer" Grid.Row="0" Background="#FF141414" CornerRadius="12,12,0,0">
            <Grid x:Name="TitleBar" shell:WindowChrome.IsHitTestVisibleInChrome="True" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Title text area (draggable) -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center" Margin="16,0,0,0" 
                           shell:WindowChrome.IsHitTestVisibleInChrome="True" Background="Transparent">
                    <Image Source="images/nobgicon.png" 
                           Width="20" Height="20" 
                           Margin="0,0,8,0"
                           VerticalAlignment="Center"
                           RenderOptions.BitmapScalingMode="HighQuality"
                           UseLayoutRounding="True"
                           SnapsToDevicePixels="True"/>
                    <TextBlock x:Name="TitleText" 
                               Text="Crunchyroll For Desktop"
                               FontFamily="pack://application:,,,/;component/font/Inter/Inter.ttf#Inter, Inter, Segoe UI"
                               FontWeight="Bold"
                               FontSize="14"
                               Foreground="#F47521"
                               VerticalAlignment="Center"
                               TextOptions.TextFormattingMode="Display"
                               TextOptions.TextRenderingMode="ClearType"/>
                </StackPanel>
                
                <!-- Hardware acceleration toggle and window control buttons -->
                <StackPanel x:Name="WindowButtonsPanel" Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,8,0">
                    <Button x:Name="HardwareAccelToggle" Style="{StaticResource ModernWindowButton}" Click="HardwareAccelToggle_Click" Content="&#xE950;" ToolTip="Hardware Acceleration: ON" 
                           shell:WindowChrome.IsHitTestVisibleInChrome="True" Foreground="#4CAF50" Margin="2,2,8,2" FontSize="21"/>
                    <Button x:Name="MinButton" Style="{StaticResource ModernWindowButton}" Click="MinButton_Click" Content="&#xE921;" ToolTip="Minimize" 
                           shell:WindowChrome.IsHitTestVisibleInChrome="True"/>
                    <Button x:Name="MaxButton" Style="{StaticResource ModernWindowButton}" Click="MaxButton_Click" Content="&#xE922;" ToolTip="Maximize" 
                           shell:WindowChrome.IsHitTestVisibleInChrome="True"/>
                    <Button x:Name="CloseButton" Style="{StaticResource ModernCloseButton}" Click="CloseButton_Click" Content="&#xE8BB;" ToolTip="Close"
                           shell:WindowChrome.IsHitTestVisibleInChrome="True"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- WebView2 Host -->
        <Border Grid.Row="1" CornerRadius="0,0,12,12" ClipToBounds="True">
            <wv2:WebView2 x:Name="Web"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"/>
        </Border>
        </Grid>
    </Border>
</Window>
